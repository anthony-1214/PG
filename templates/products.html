{% extends "base.html" %}
{% block content %}
<h3 class="mb-3">Products</h3>
<div class="row g-3">
  {% for p in products %}
  <div class="col-md-4">
    <div class="card h-100">
      {% if p.image_url %}
      <img src="{{ p.image_url }}" class="card-img-top" alt="{{ p.name }}">
      {% endif %}
      <div class="card-body">
        <h5 class="card-title">{{ p.name }}</h5>
        <p class="card-text mb-2">Size: {{ p.size }} | Stock: {{ p.stock }}</p>
        <div class="d-flex justify-content-between align-items-center">
          <span class="fw-bold">$ {{ '%.2f'|format(p.price) }}</span>

          <div class="btn-group">
            <!-- 加入購物車：參數名 pid ✅ -->
            <form method="post" action="{{ url_for('add_to_cart', pid=p.id) }}" class="me-1">
              <button class="btn btn-primary btn-sm" {% if p.stock <= 0 %}disabled{% endif %}>Add</button>
            </form>

            <!-- 刪除商品：參數名也要用 pid ✅ -->
            <form method="post"
                  action="{{ url_for('delete_product', pid=p.id) }}"
                  onsubmit="return confirm('確定要刪除此商品嗎？');">
              <button class="btn btn-danger btn-sm">Delete</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
